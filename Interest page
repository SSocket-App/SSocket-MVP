// App.js — SSocket Interest Selection (PersonalSignup UI applied)
// Paste this into Expo Snack (App.js). No extra dependencies.

import React, { useState } from "react";
import {
  SafeAreaView,
  View,
  Text,
  StyleSheet,
  TouchableOpacity,
  ScrollView,
  StatusBar,
  Platform,
  Alert,
} from "react-native";

const YELLOW = "#FFD54A";
const BLACK = "#000";
const WHITE = "#FFF";
const MUTED = "#6B7280";

// Grouped categories (expand to view subcategories)
const CATEGORIES = [
  {
    key: "hospitality",
    title: "Hospitality & Domestic",
    items: [
      "Waiter / Waitress",
      "Bartender / Bar Staff",
      "Hotel Front Desk",
      "Housekeeping (Hotel)",
      "Househelp / Domestic Worker",
      "Kitchen Assistant",
      "Event Staff / Usher",
      "Catering / Cook",
      "Laundry Attendant",
      "Nanny / Childcare",
      "Spa Therapist / Masseuse",
    ],
  },
  {
    key: "cleaning",
    title: "Cleaning & Facility",
    items: [
      "Cleaner / Janitor",
      "Security Guard",
      "Facility Maintenance",
      "Office Assistant",
      "Caretaker / Building Manager",
    ],
  },
  {
    key: "manufacturing",
    title: "Manufacturing & Warehouse",
    items: [
      "Factory Worker",
      "Warehouse / Inventory Clerk",
      "Machine Operator",
      "Quality Control Inspector",
      "Packing & Sorting Staff",
    ],
  },
  {
    key: "trades",
    title: "Trades & Skilled Labour",
    items: [
      "Electrician (incl. Solar)",
      "Plumber",
      "Welder / Fabricator",
      "Mason / Bricklayer",
      "Carpenter",
      "Mechanic (Auto / Generator / Bike)",
      "Painter & Decorator",
      "Tailor / Fashion Designer",
      "Shoe Maker / Cobbler",
      "Hair Stylist",
      "Barber",
    ],
  },
  {
    key: "transport",
    title: "Transport & Delivery",
    items: [
      "Driver (Private / Bus / Truck)",
      "Dispatch Rider",
      "Logistics / Courier",
      "Boat Operator",
    ],
  },
  {
    key: "retail",
    title: "Retail & Sales",
    items: [
      "Shopkeeper",
      "Market Trader",
      "Sales Promoter",
      "Supermarket Cashier",
      "Merchandiser",
    ],
  },
  {
    key: "office",
    title: "Office & Professional",
    items: [
      "Customer Service / Call Centre",
      "Data Entry / Admin Clerk",
      "Accountant / Bookkeeper",
      "HR / Staff Management",
      "Marketing / Growth",
      "Project Manager",
      "Receptionist",
      "Procurement Officer",
      "Secretary",
    ],
  },
  {
    key: "techcreative",
    title: "Technology & Creative",
    items: [
      "Graphic Designer",
      "Video Editor",
      "Photographer",
      "Social Media Manager",
      "Web Developer",
      "Mobile App Developer",
      "IT Support",
      "Content Writer",
      "SEO Specialist",
      "Animator",
    ],
  },
  {
    key: "education",
    title: "Education & Training",
    items: [
      "Teacher (Primary / Secondary)",
      "Lecturer / University",
      "Tutor (Private Lessons)",
      "Vocational Skills Trainer",
      "Language Instructor",
    ],
  },
  {
    key: "healthcare",
    title: "Healthcare",
    items: [
      "Nurse",
      "Doctor",
      "Laboratory Technician",
      "Pharmacist",
      "Caregiver / Health Assistant",
    ],
  },
  {
    key: "agriculture",
    title: "Agriculture & Farming",
    items: [
      "Crop Farmer",
      "Poultry Farmer",
      "Fish Farmer",
      "Farm Labourer",
      "Agro-Processing Worker",
    ],
  },
  {
    key: "repairs",
    title: "Maintenance & Repairs",
    items: [
      "Building Maintenance",
      "AC / Refrigerator Repair",
      "Electronics Repair",
      "Mobile Phone Repair",
      "Generator Repair",
    ],
  },
  {
    key: "engineering",
    title: "Engineering & Technical",
    items: [
      "Civil Engineer",
      "Mechanical Engineer",
      "Electrical Engineer",
      "Structural Engineer",
      "Chemical Engineer",
      "Industrial Engineer",
      "Agricultural Engineer",
      "Environmental Engineer",
      "Petroleum Engineer",
      "Mining Engineer",
      "Water / Sanitation Engineer",
    ],
  },
];

export default function App() {
  StatusBar.setBarStyle("light-content");

  const [openGroups, setOpenGroups] = useState({});
  const [selected, setSelected] = useState([]);

  const toggleGroup = (key) => {
    setOpenGroups((prev) => ({
      ...prev,
      [key]: !prev[key],
    }));
  };

  const toggleItem = (label) => {
    setSelected((prev) => {
      if (prev.includes(label)) {
        return prev.filter((x) => x !== label);
      }
      return [...prev, label];
    });
  };

  const canContinue = selected.length >= 3;

  const onContinue = () => {
    if (!canContinue) {
      Alert.alert("Pick more", "Please select at least 3 interests.");
      return;
    }
    Alert.alert("Selected", selected.join(", "));
  };

  return (
    <SafeAreaView style={styles.container}>
      <StatusBar barStyle="light-content" backgroundColor={BLACK} />

      {/* Header (PersonalSignup style) */}
      <View style={styles.topBar}>
        <Text style={styles.topBarTitle}>Select Interests</Text>
      </View>
      <View style={styles.topAccent} />

      <ScrollView contentContainerStyle={styles.scroll}>
        {/* Title + Sub */}
        <Text style={styles.h1}>
          What kind of problems would you like to solve on SSocket?
        </Text>
        <Text style={styles.sub}>
          Pick your areas. We’ll tailor gigs, people and tools to match.
        </Text>

        {/* Groups */}
        {CATEGORIES.map((cat) => {
          const isOpen = !!openGroups[cat.key];
          return (
            <View key={cat.key} style={styles.groupCard}>
              <TouchableOpacity
                onPress={() => toggleGroup(cat.key)}
                activeOpacity={0.9}
                style={styles.groupHeader}
              >
                <Text style={styles.groupTitle}>{cat.title}</Text>
                <Text style={styles.chev}>{isOpen ? "−" : "+"}</Text>
              </TouchableOpacity>

              {isOpen ? (
                <View style={styles.chipsWrap}>
                  {cat.items.map((label) => {
                    const active = selected.includes(label);
                    return (
                      <TouchableOpacity
                        key={label}
                        onPress={() => toggleItem(label)}
                        activeOpacity={0.85}
                        style={[styles.chip, active && styles.chipActive]}
                      >
                        <Text
                          style={[styles.chipText, active && styles.chipTextActive]}
                        >
                          {label}
                        </Text>
                      </TouchableOpacity>
                    );
                  })}
                </View>
              ) : null}
            </View>
          );
        })}
      </ScrollView>

      {/* Footer CTA (PersonalSignup primaryBtn style) */}
      <View style={styles.footer}>
        <TouchableOpacity
          onPress={onContinue}
          activeOpacity={canContinue ? 0.9 : 1}
          disabled={!canContinue}
          style={[styles.primaryBtn, !canContinue && { opacity: 0.4 }]}
        >
          <Text style={styles.primaryBtnTxt}>
            Continue ⚡  ({selected.length})
          </Text>
        </TouchableOpacity>

        {!canContinue ? (
          <Text style={styles.hint}>Select at least 3 interests to continue.</Text>
        ) : (
          <Text style={styles.hintOK}>Nice! You’re good to go.</Text>
        )}
      </View>
    </SafeAreaView>
  );
}

/* -------------------- Styles (mirroring PersonalSignup UI) -------------------- */
const styles = StyleSheet.create({
  container: { flex: 1, backgroundColor: WHITE },

  /* Header */
  topBar: {
    backgroundColor: BLACK,
    height: 88,
    paddingTop: Platform.OS === "android" ? (StatusBar.currentHeight || 0) : 12,
    alignItems: "center",
    justifyContent: "flex-end",
    paddingBottom: 14,
  },
  topBarTitle: { color: WHITE, fontSize: 22, fontWeight: "900" },
  topAccent: { height: 3, backgroundColor: YELLOW },

  /* Body */
  scroll: { paddingHorizontal: 16, paddingBottom: 24 },
  h1: { fontSize: 18, fontWeight: "900", color: BLACK, marginTop: 10 },
  sub: { marginTop: 4, fontSize: 13, color: MUTED },

  /* Group cards (switch to black-outline, white fill) */
  groupCard: {
    marginTop: 12,
    padding: 0,
    borderRadius: 12,
    borderWidth: 2,
    borderColor: BLACK,
    backgroundColor: WHITE,
    overflow: "hidden",
  },
  groupHeader: {
    paddingHorizontal: 14,
    paddingVertical: 12,
    flexDirection: "row",
    alignItems: "center",
    justifyContent: "space-between",
    backgroundColor: WHITE,
  },
  groupTitle: { fontSize: 16, fontWeight: "900", color: BLACK },
  chev: { fontSize: 22, fontWeight: "900", color: BLACK },

  chipsWrap: {
    flexDirection: "row",
    flexWrap: "wrap",
    paddingHorizontal: 10,
    paddingBottom: 12,
    gap: 8,
  },

  /* Chips — match input/button vibe: black border, yellow active */
  chip: {
    borderWidth: 2,
    borderColor: BLACK,
    paddingHorizontal: 12,
    paddingVertical: 8,
    borderRadius: 999,
    backgroundColor: WHITE,
  },
  chipActive: {
    backgroundColor: YELLOW,
    borderColor: BLACK,
  },
  chipText: { fontSize: 12, fontWeight: "900", color: BLACK },
  chipTextActive: { color: BLACK },

  /* Footer CTA — same as PersonalSignup primary button */
  footer: { paddingHorizontal: 16, paddingBottom: 18, paddingTop: 6 },
  primaryBtn: {
    backgroundColor: YELLOW,
    borderRadius: 12,
    borderWidth: 2,
    borderColor: BLACK,
    paddingVertical: 14,
    alignItems: "center",
  },
  primaryBtnTxt: { color: BLACK, fontWeight: "900", fontSize: 16 },
  hint: { textAlign: "center", marginTop: 8, color: MUTED, fontSize: 12 },
  hintOK: { textAlign: "center", marginTop: 8, color: "#16a34a", fontSize: 12, fontWeight: "700" },
});
